package com.main.src.tlhf.util.export.word.test1;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class Test2 {
	public static List<IndoorEnvBean> initData(List<IndoorEnvBean> list) {
		IndoorEnvBean user = new IndoorEnvBean();
		user.setCheck_nm("1");
		user.setCheck_name("Python");
		user.setLimit_value("learn");
		user.setCheck_station("第一天");
		user.setCheck_point("1");
		user.setCheck_value("0.01");
		user.setCheck_average("—");
		user.setCheck_rtn("合格");
		list.add(user);

		IndoorEnvBean user2 = new IndoorEnvBean();
		user2.setCheck_nm("1");
		user2.setCheck_name("Python");
		user2.setLimit_value("learn");
		user2.setCheck_station("第二天");
		user2.setCheck_point("2");
		user2.setCheck_value("0.01");
		user2.setCheck_average("—");
		user2.setCheck_rtn("合格");
		list.add(user2);

		IndoorEnvBean user3 = new IndoorEnvBean();
		user3.setCheck_nm("1");
		user3.setCheck_name("Python");
		user3.setLimit_value("learn");
		user3.setCheck_station("第三天");
		user3.setCheck_point("3");
		user3.setCheck_value("0.01");
		user3.setCheck_average("—");
		user3.setCheck_rtn("合格");
		list.add(user3);

		IndoorEnvBean user4 = new IndoorEnvBean();
		user4.setCheck_nm("1");
		user4.setCheck_name("Python");
		user4.setLimit_value("learn");
		user4.setCheck_station("第四天");
		user4.setCheck_point("4");
		user4.setCheck_value("0.01");
		user4.setCheck_average("—");
		user4.setCheck_rtn("合格");
		list.add(user4);

		IndoorEnvBean user5 = new IndoorEnvBean();
		user5.setCheck_nm("1");
		user5.setCheck_name("Python");
		user5.setLimit_value("learn");
		user5.setCheck_station("第五天");
		user5.setCheck_point("5");
		user5.setCheck_value("0.01");
		user5.setCheck_average("—");
		user5.setCheck_rtn("合格");
		list.add(user5);

		IndoorEnvBean user6 = new IndoorEnvBean();
		user6.setCheck_nm("1");
		user6.setCheck_name("Python");
		user6.setLimit_value("learn");
		user6.setCheck_station("第六天");
		user6.setCheck_point("6");
		user6.setCheck_value("0.01");
		user6.setCheck_average("—");
		user6.setCheck_rtn("合格");
		list.add(user6);

		IndoorEnvBean user7 = new IndoorEnvBean();
		user7.setCheck_nm("1");
		user7.setCheck_name("Python");
		user7.setLimit_value("learn");
		user7.setCheck_station("第七天");
		user7.setCheck_point("7");
		user7.setCheck_value("0.01");
		user7.setCheck_average("—");
		user7.setCheck_rtn("合格");
		list.add(user7);

		IndoorEnvBean user8 = new IndoorEnvBean();
		user8.setCheck_nm("1");
		user8.setCheck_name("Python");
		user8.setLimit_value("learn");
		user8.setCheck_station("第八天");
		user8.setCheck_point("8");
		user8.setCheck_value("0.01");
		user8.setCheck_average("—");
		user8.setCheck_rtn("合格");
		list.add(user8);

		IndoorEnvBean user9 = new IndoorEnvBean();
		user9.setCheck_nm("1");
		user9.setCheck_name("Python");
		user9.setLimit_value("learn");
		user9.setCheck_station("第九天");
		user9.setCheck_point("9");
		user9.setCheck_value("0.01");
		user9.setCheck_average("—");
		user9.setCheck_rtn("合格");
		list.add(user9);

		IndoorEnvBean user10 = new IndoorEnvBean();
		user10.setCheck_nm("1");
		user10.setCheck_name("Python");
		user10.setLimit_value("learn");
		user10.setCheck_station("第十天");
		user10.setCheck_point("10");
		user10.setCheck_value("0.01");
		user10.setCheck_average("—");
		user10.setCheck_rtn("合格");
		list.add(user10);

		IndoorEnvBean user11 = new IndoorEnvBean();
		user11.setCheck_nm("1");
		user11.setCheck_name("Python");
		user11.setLimit_value("learn");
		user11.setCheck_station("第十一天");
		user11.setCheck_point("11");
		user11.setCheck_value("0.01");
		user11.setCheck_average("—");
		user11.setCheck_rtn("合格");
		list.add(user11);

		IndoorEnvBean user12 = new IndoorEnvBean();
		user12.setCheck_nm("1");
		user12.setCheck_name("Python");
		user12.setLimit_value("learn");
		user12.setCheck_station("第十二天");
		user12.setCheck_point("12");
		user12.setCheck_value("0.01");
		user12.setCheck_average("—");
		user12.setCheck_rtn("合格");
		list.add(user12);

		IndoorEnvBean user13 = new IndoorEnvBean();
		user13.setCheck_nm("1");
		user13.setCheck_name("Python");
		user13.setLimit_value("learn");
		user13.setCheck_station("第十三天");
		user13.setCheck_point("13");
		user13.setCheck_value("0.01");
		user13.setCheck_average("—");
		user13.setCheck_rtn("合格");
		list.add(user13);

		IndoorEnvBean user14 = new IndoorEnvBean();
		user14.setCheck_nm("1");
		user14.setCheck_name("Python");
		user14.setLimit_value("learn");
		user14.setCheck_station("第十四天");
		user14.setCheck_point("14");
		user14.setCheck_value("0.01");
		user14.setCheck_average("0.01");
		user14.setCheck_rtn("合格");
		list.add(user14);

		IndoorEnvBean user15 = new IndoorEnvBean();
		user15.setCheck_nm("1");
		user15.setCheck_name("Python");
		user15.setLimit_value("learn");
		user15.setCheck_station("第十四天");
		user15.setCheck_point("15");
		user15.setCheck_value("0.01");
		user15.setCheck_average("0.01");
		user15.setCheck_rtn("合格");
		list.add(user15);

		IndoorEnvBean user16 = new IndoorEnvBean();
		user16.setCheck_nm("1");
		user16.setCheck_name("Python");
		user16.setLimit_value("learn");
		user16.setCheck_station("第十五天");
		user16.setCheck_point("16");
		user16.setCheck_value("0.01");
		user16.setCheck_average("0.01");
		user16.setCheck_rtn("合格");
		list.add(user16);

		IndoorEnvBean user17 = new IndoorEnvBean();
		user17.setCheck_nm("1");
		user17.setCheck_name("Python");
		user17.setLimit_value("learn");
		user17.setCheck_station("第十五天");
		user17.setCheck_point("17");
		user17.setCheck_value("0.01");
		user17.setCheck_average("0.01");
		user17.setCheck_rtn("合格");
		list.add(user17);

		IndoorEnvBean user18 = new IndoorEnvBean();
		user18.setCheck_nm("1");
		user18.setCheck_name("Python");
		user18.setLimit_value("learn");
		user18.setCheck_station("第十五天");
		user18.setCheck_point("18");
		user18.setCheck_value("0.01");
		user18.setCheck_average("0.01");
		user18.setCheck_rtn("合格");
		list.add(user18);

		return list;
	}

	public static List<IndoorEnvBean> checkList(List<IndoorEnvBean> list) {
		String start = "<w:vMerge w:val='restart'/>";
		String end = "<w:vMerge/>";

		for (int i = 0; i < list.size(); i++) {
			if (i == 0) {
				continue;
			}
			if (list.get(i).getCheck_nm().equals(list.get(i - 1).getCheck_nm())) {
				list.get(i).setCheck_nm_end(end);
				if (list.get(i - 1).getCheck_nm_end() == null) {
					list.get(i - 1).setCheck_nm_start(start);
				}
			}
			if (list.get(i).getCheck_name()
					.equals(list.get(i - 1).getCheck_name())) {
				list.get(i).setCheck_name_end(end);
				if (list.get(i - 1).getCheck_name_end() == null) {
					list.get(i - 1).setCheck_name_start(start);
				}
			}
			if (list.get(i).getLimit_value()
					.equals(list.get(i - 1).getLimit_value())) {
				list.get(i).setLimit_value_end(end);
				if (list.get(i - 1).getLimit_value_end() == null) {
					list.get(i - 1).setLimit_value_start(start);
				}
			}
			if (list.get(i).getCheck_station()
					.equals(list.get(i - 1).getCheck_station())) {
				list.get(i).setCheck_station_end(end);
				list.get(i).setCheck_average_end(end);
				if (list.get(i - 1).getCheck_station_end() == null) {
					list.get(i - 1).setCheck_station_start(start);
					list.get(i - 1).setCheck_average_start(start);
				}
			}
		}

		return list;
	}
	/**
	 * @param args
	 */
	public static void main(String[] args) {
		ExportMyWord emw = new ExportMyWord();
		Map<String, Object> dataMap = new HashMap<String, Object>();
		dataMap.put("tlhf_name", "我爱编程");
		dataMap.put("entrusted_name", "Python");
		dataMap.put("obj_name", "JAVA JAVA JAVA JAVA JAVA JAVA");
		dataMap.put("const_name", "Perl Perl Perl Perl");
		dataMap.put("design_name", "AWS AWS AWS AWS AWS AWS");
		dataMap.put("const_unit_name", "NIFI NIFI NIFI NIFI");
		dataMap.put("supervision_name", "Kafka Kafka kafka");
		dataMap.put("struc_type", "spark spark");
		dataMap.put("level", "hbase hbase");
		dataMap.put("area", "hive");
		dataMap.put("check_type", "scala");
		dataMap.put("bh_year", "2019");
		dataMap.put("bh_nm", "0830-17");
		dataMap.put("qf_year", "2019");
		dataMap.put("qf_month", "08");
		dataMap.put("qf_day", "30");
		dataMap.put("obj_addr", "docker");
		dataMap.put("check_list", "berlin sos");
		dataMap.put("conclusion", "spss");

		List<IndoorEnvBean> userList = new ArrayList<IndoorEnvBean>();
		userList = initData(userList);

		dataMap.put("items", checkList(userList));

		emw.createWord(dataMap, "test2.ftl", "C:\\work\\test2.doc");
	}

}
